{"remainingRequest":"/Users/lisa/Desktop/study/mongodb+express/my-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lisa/Desktop/study/mongodb+express/my-project/src/components/about.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lisa/Desktop/study/mongodb+express/my-project/src/components/about.vue","mtime":1588238583699},{"path":"/Users/lisa/Desktop/study/mongodb+express/my-project/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lisa/Desktop/study/mongodb+express/my-project/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lisa/Desktop/study/mongodb+express/my-project/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lisa/Desktop/study/mongodb+express/my-project/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJhYm91dCIsCiAgLy8g6LCD55SoYXBwLnZ1Zee7hOS7tuS4reeahOaWueazlQogIGluamVjdDogWyJyZWxvYWQiXSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbXNnOiAi5Yqg6L295Lit44CC44CC44CCIiwKICAgICAgYnVzeTogdHJ1ZSwKICAgICAgbGlzdDogW10sCiAgICAgIHBhZ2U6IDEsCiAgICAgIGFsbGNoZWNrOiBmYWxzZSwKICAgICAgc29ydGZhbGc6IHRydWUsCiAgICAgIHByaWNlQ2hlY2tlZDogZmFsc2UKICAgIH07CiAgfSwKICAvLyDmgLvku7fnmoTlrp7ml7bnm5HlkKwKICBjb21wdXRlZDogewogICAgdG90YWxNb25leSgpIHsKICAgICAgbGV0IGFsbG1vbmV5ID0gMDsKICAgICAgbGV0IGlzQWxsQ2hlY2sgPSB0cnVlOwogICAgICBmb3IgKGxldCBpIGluIHRoaXMubGlzdCkgewogICAgICAgIGlmICh0aGlzLmxpc3RbaV0uY2hlY2tlZCkgewogICAgICAgICAgYWxsbW9uZXkgKz0gdGhpcy5saXN0W2ldLnByb2R1Y3ROdW0gKiB0aGlzLmxpc3RbaV0uc2FsZVByaWNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpc0FsbENoZWNrID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuYWxsY2hlY2sgPT0gaXNBbGxDaGVjazsKICAgICAgcmV0dXJuIGFsbG1vbmV5OwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgbG9hZE1vcmUoKSB7CiAgICAgIC8vIOWBnOatouWKoOi9veS6i+S7tueahOinpuWPkQogICAgICB0aGlzLmJ1c3kgPSB0cnVlOwogICAgICBjb25zb2xlLmxvZygi6K6w6L29Iik7CiAgICAgIC8vICDmu5rliqjmnaHkvJrop6blj5HlpJrmnaHlj5HpgIHkuovku7bvvIzpgKDmiJDmnI3liqHlmajljovlipvvvIzkvb/nlKjlu7bml7blh73mlbDnrYnnrKzkuIDmnaHor7fmsYLnu5PmnZ/lkI7lj5HpgIHnrKzkuozkuKror7fmsYIKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5wYWdlKys7CiAgICAgICAgLy8g6LCD55So6K+35rGC5ZCO56uv5pWw5o2u5pa55rOV55Sx5LqO5pWw5o2u6ZyA6KaB57Sv5Yqg77yM5pWF6K+35rGC5pe25Lyg5Y+C77yM5aaC5p6c5bey57uP5Yqg6L295LqG5pWw5o2u77yM5bCx6L+b6KGM57Sv5Yqg5aSE55CG44CCCiAgICAgICAgdGhpcy5nZXRwcm9kdWN0KHRydWUpOwogICAgICB9LCAxMDAwKTsKICAgIH0sCiAgICAvLyDor7fmsYLlkI7nq6/mlbDmja4KICAgIGFzeW5jIGdldHByb2R1Y3QoZmxhZykgewogICAgICAvLyDkvKDlj4IKICAgICAgbGV0IHBhcmFtID0gewogICAgICAgIHBhZ2U6IHRoaXMucGFnZSwKICAgICAgICByb3c6IDEsCiAgICAgICAgc29ydDogMQogICAgICB9OwogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLmdldCgiL2dvb2RzbGlzdCIsIHsgcGFyYW1zOiBwYXJhbSB9KTsKICAgICAgaWYgKGZsYWcpIHsKICAgICAgICAvLyBjb25jYXTlrp7njrDmlbDmja7nmoTlj6DliqAKICAgICAgICB0aGlzLmxpc3QgPSB0aGlzLmxpc3QuY29uY2F0KHJlcy5kYXRhLnJlc3VsdC5saXN0KTsKICAgICAgICAvLyDlpoLmnpzlkI7nq6/mlbDmja7mnaHmlbDkuLowIOWBnOatouWKoOi9veS6i+S7tueahOinpuWPkQogICAgICAgIGlmIChyZXMuZGF0YS5yZXN1bHQuY291bnQgPT0gMCkgewogICAgICAgICAgdGhpcy5idXN5ID0gdHJ1ZTsKICAgICAgICAgIHRoaXMubXNnID0gIuaVsOaNruWKoOi9veWujOaIkCI7CiAgICAgICAgICBjb25zb2xlLmxvZygi5a6M5oiQIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYnVzeSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmxpc3QgPSByZXMuZGF0YS5yZXN1bHQubGlzdDsKICAgICAgICAvLyDpu5jorqRmYWxn5pivZmFsc2Us5bCx5LiN5omn6KGM5YmN6Z2i55qEaWbor63lj6XvvIzkuI3kvJrop6blj5Fsb2FkbW9yZSgpCiAgICAgICAgdGhpcy5idXN5ID0gZmFsc2U7CiAgICAgIH0KICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInNob3BwaW5nY2FydCIsIEpTT04uc3RyaW5naWZ5KHRoaXMubGlzdCkpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLmxpc3RbMF0ucHJvZHVjdEltYWdlKTsKICAgIH0sCiAgICAvLyDmlbDph48KICAgIGVkaXRDYXJ0KGZsYWcsIGl0ZW0pIHsKICAgICAgaWYgKGZsYWcgPT0gImFkZCIpIHsKICAgICAgICAvLyDmt7vliqDllYblk4HmlbDph48KICAgICAgICBpdGVtLnByb2R1Y3ROdW0rKzsKICAgICAgfSBlbHNlIGlmIChmbGFnID09ICJtaW51IikgewogICAgICAgIC8vIOWHj+WwkeWVhuWTgeaVsOmHjwogICAgICAgIGlmIChpdGVtLnByb2R1Y3ROdW0gPD0gMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpdGVtLnByb2R1Y3ROdW0tLTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhOdW1iZXIoaXRlbS5wcm9kdWN0TnVtKSApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5ZWG5ZOB5o6n5Yi26YCJ5LitCiAgICAgICAgaXRlbS5jaGVja2VkID0gaXRlbS5jaGVja2VkID09ICIxIiA/ICIxIiA6ICIwIjsKICAgICAgfQogICAgICB0aGlzLiRodHRwCiAgICAgICAgLnBvc3QoIi9jYXJ0RWRpdCIsIHsKICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQsCiAgICAgICAgICBwcm9kdWN0TnVtOiBpdGVtLnByb2R1Y3ROdW0KICAgICAgICAgIC8vIGNoZWNrZWQ6IGl0ZW0uY2hlY2tlZAogICAgICAgIH0pCiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgbGV0IHJlcyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICBjb25zb2xlLmxvZygxMTEsIHJlcyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgLy8g5YWo6YCJCiAgICBjaGVja2FsbCgpIHsKICAgICAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0LmNoZWNrZWQpOwogICAgICB0aGlzLmxpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICBpdGVtLmNoZWNrZWQgPSBldmVudC50YXJnZXQuY2hlY2tlZDsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5Y+N6YCJCiAgICBfY2hlY2tBbGwoKSB7CiAgICAgIC8vICDpgY3ljobmiYDmnInnmoTmlbDmja7lpoLmnpzpg73pgInkuK3liJnlhajpgInpgInkuK0KICAgICAgaWYgKHRoaXMubGlzdC5ldmVyeShpdGVtID0+IGl0ZW0uY2hlY2tlZCkpIHsKICAgICAgICB0aGlzLmFsbGNoZWNrID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFsbGNoZWNrID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICAvLyDliKDpmaTllYblk4EKICAgIGFzeW5jIGRlbChpZCkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLmRlbGV0ZSgiL2NhcnREZWwvIiArIGlkKTsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgdGhpcy5yZWxvYWQoKTsKICAgIH0sCiAgICAvLyDku7fmoLzov4fmu6QKICAgIHNldHByaWNlZmlsdGVyKGluZGV4KSB7CiAgICAgIHRoaXMubGV2ZWwgPSBpbmRleDsKICAgICAgdGhpcy5wYWdlID0gMTsKICAgICAgdGhpcy5nZXRwcm9kdWN0KHRydWUpOwogICAgfSwKICAgIC8vIOWVhuWTgemZjeW6jwogICAgc29ydEdvb2RzKCkgewogICAgICB0aGlzLnNvcnRmYWxnID0gIXRoaXMuc29ydGZhbGc7CiAgICAgIHRoaXMucGFnZSA9IDE7CiAgICAgIHRoaXMuZ2V0cHJvZHVjdCh0cnVlKTsKICAgIH0sCiAgICAvLyDliqDlhaXotK3nianovaYKICAgIGFkZGNhcnQoaWQpIHsKICAgICAgdGhpcy4kaHR0cAogICAgICAgIC5wb3N0KCIvZ29vZHMvYWRkY2FydCIsIHsKICAgICAgICAgIF9pZDogaWQKICAgICAgICB9KQogICAgICAgIC50aGVuKHJlcyA9PiB7CiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgYWxlcnQoIuWKoOWFpeaIkOWKnyIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoIuWKoOWFpeWksei0pSIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0cHJvZHVjdCgpOwogIH0KfTsK"},{"version":3,"sources":["about.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"about.vue","sourceRoot":"src/components","sourcesContent":["<!--\n * @Author: your name\n * @Date: 2020-03-07 17:05:46\n * @LastEditTime: 2020-03-18 10:57:31\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /all/my-project/src/components/about.vue\n -->\n<template>\n  <div class=\"about container\">\n    <!-- 方法，需不需要禁用，false，滚动距离里下面多远触发方法 -->\n    <button class=\"btn btn-default\">\n      <router-link to=\"/customers\">返回主页</router-link>\n    </button>\n    <br />\n    <button @click=\"sortGoods\">降序排列</button>\n    <ul>\n      <li v-for=\"(item,index) in this.list\" :key=\"index\">\n        <div>\n          <h3>{{item.productName}}</h3>\n          <img src=\"../assets/img/q.jpg\" alt width=\"100px\" height=\"300px\" />\n          <input type=\"checkbox\" v-model=\"item.checked\" @change=\"_checkAll\" />\n          <span>{{item.produceName}}</span>\n          <button class=\"btn btn-default\" @click=\"editCart('minu',item)\">-</button>\n          <span>{{item.productNum}}</span>\n          <button class=\"btn btn-default\" @click=\"editCart('add',item)\">+</button>\n          <span>价格：{{item.salePrice}}</span>\n          <button @click=\"del(item._id)\" class=\"btn btn-default\">删除</button>\n        </div>\n        <button @click=\"addcart(item._id)\">加入购物车</button>\n      </li>\n    </ul>\n    <div\n      class=\"load-more\"\n      v-infinite-scroll=\"loadMore\"\n      infinite-scroll-disabled=\"busy\"\n      infinite-scroll-distance=\"30\"\n    >{{msg}}</div>\n    <input type=\"checkbox\" id=\"allCheckBox\" v-model=\"allcheck\" @click=\"checkall\" />\n    <button>合计:{{totalMoney}}</button>\n  </div>\n</template>\n\n<script>\n// import { mapGetters } from \"vuex\";\nexport default {\n  name: \"about\",\n  // 调用app.vue组件中的方法\n  inject: [\"reload\"],\n  data() {\n    return {\n      msg: \"加载中。。。\",\n      busy: true,\n      list: [],\n      page: 1,\n      allcheck: false,\n      sortfalg: true,\n      priceChecked: false\n    };\n  },\n  // 总价的实时监听\n  computed: {\n    totalMoney() {\n      let allmoney = 0;\n      let isAllCheck = true;\n      for (let i in this.list) {\n        if (this.list[i].checked) {\n          allmoney += this.list[i].productNum * this.list[i].salePrice;\n        } else {\n          isAllCheck = false;\n        }\n      }\n      this.allcheck == isAllCheck;\n      return allmoney;\n    }\n  },\n  methods: {\n    loadMore() {\n      // 停止加载事件的触发\n      this.busy = true;\n      console.log(\"记载\");\n      //  滚动条会触发多条发送事件，造成服务器压力，使用延时函数等第一条请求结束后发送第二个请求\n      setTimeout(() => {\n        this.page++;\n        // 调用请求后端数据方法由于数据需要累加，故请求时传参，如果已经加载了数据，就进行累加处理。\n        this.getproduct(true);\n      }, 1000);\n    },\n    // 请求后端数据\n    async getproduct(flag) {\n      // 传参\n      let param = {\n        page: this.page,\n        row: 1,\n        sort: 1\n      };\n      const res = await this.$http.get(\"/goodslist\", { params: param });\n      if (flag) {\n        // concat实现数据的叠加\n        this.list = this.list.concat(res.data.result.list);\n        // 如果后端数据条数为0 停止加载事件的触发\n        if (res.data.result.count == 0) {\n          this.busy = true;\n          this.msg = \"数据加载完成\";\n          console.log(\"完成\");\n        } else {\n          this.busy = false;\n        }\n      } else {\n        this.list = res.data.result.list;\n        // 默认falg是false,就不执行前面的if语句，不会触发loadmore()\n        this.busy = false;\n      }\n      localStorage.setItem(\"shoppingcart\", JSON.stringify(this.list));\n      console.log(this.list[0].productImage);\n    },\n    // 数量\n    editCart(flag, item) {\n      if (flag == \"add\") {\n        // 添加商品数量\n        item.productNum++;\n      } else if (flag == \"minu\") {\n        // 减少商品数量\n        if (item.productNum <= 1) {\n          return;\n        }\n        item.productNum--;\n        // console.log(Number(item.productNum) )\n      } else {\n        // 商品控制选中\n        item.checked = item.checked == \"1\" ? \"1\" : \"0\";\n      }\n      this.$http\n        .post(\"/cartEdit\", {\n          productId: item.productId,\n          productNum: item.productNum\n          // checked: item.checked\n        })\n        .then(response => {\n          let res = response.data;\n          console.log(111, res);\n        });\n    },\n    // 全选\n    checkall() {\n      console.log(event.target.checked);\n      this.list.forEach(item => {\n        item.checked = event.target.checked;\n      });\n    },\n    // 反选\n    _checkAll() {\n      //  遍历所有的数据如果都选中则全选选中\n      if (this.list.every(item => item.checked)) {\n        this.allcheck = true;\n      } else {\n        this.allcheck = false;\n      }\n    },\n    // 删除商品\n    async del(id) {\n      const res = await this.$http.delete(\"/cartDel/\" + id);\n      console.log(res);\n      this.reload();\n    },\n    // 价格过滤\n    setpricefilter(index) {\n      this.level = index;\n      this.page = 1;\n      this.getproduct(true);\n    },\n    // 商品降序\n    sortGoods() {\n      this.sortfalg = !this.sortfalg;\n      this.page = 1;\n      this.getproduct(true);\n    },\n    // 加入购物车\n    addcart(id) {\n      this.$http\n        .post(\"/goods/addcart\", {\n          _id: id\n        })\n        .then(res => {\n          if (res.status == 200) {\n            alert(\"加入成功\");\n          } else {\n            alert(\"加入失败\");\n          }\n        });\n    }\n  },\n  mounted() {\n    this.getproduct();\n  }\n};\n</script>\n\n<style>\nli {\n  list-style: none;\n}\n.load-more {\n  text-align: center;\n}\n</style>"]}]}